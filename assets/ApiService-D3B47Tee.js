const c="https://restcountries.com/v3.1",r=new Map,l=1e3*60*5,f="rc_api_cache_v1";try{const t=localStorage.getItem(f);if(t){const e=JSON.parse(t);Object.entries(e).forEach(([n,a])=>r.set(n,a))}}catch{}function i(t){const e=r.get(t);return e?Date.now()-e.timestamp>l?(r.delete(t),null):e.data:null}function p(t,e){const n={timestamp:Date.now(),data:e};r.set(t,n);try{const a={};r.forEach((s,u)=>{Date.now()-s.timestamp<=l&&(a[u]=s)}),localStorage.setItem(f,JSON.stringify(a))}catch{}}async function o(t){const e=i(t);if(e)return e;try{const n=await fetch(t);if(!n.ok)throw new Error(`API error: ${n.status} ${n.statusText}`);const a=await n.json();return p(t,a),a}catch(n){const a=i(t);if(a)return a;throw n}}const h={async getAll(){const t=["cca3","name","flags","population","region","capital"].join(",");return o(`${c}/all?fields=${t}`)},async getByCode(t){if(!t)return null;const e=await o(`${c}/alpha/${t}`);return e&&e.length?e[0]:null},async searchByName(t){if(!t)return[];const e=["cca3","name","flags","population","region","capital"].join(",");return o(`${c}/name/${encodeURIComponent(t)}?fields=${e}`)},async filterByRegion(t){if(!t)return[];const e=["cca3","name","flags","population","region","capital"].join(",");return o(`${c}/region/${encodeURIComponent(t)}?fields=${e}`)},async getByCodes(t){if(!t||t.length===0)return[];const e=t.join(","),n=["cca3","name","flags"].join(",");return o(`${c}/alpha?codes=${e}&fields=${n}`)}};export{h as A};
